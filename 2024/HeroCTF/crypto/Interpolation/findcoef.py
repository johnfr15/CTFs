from sympy import symbols, expand, Matrix

# Define the polynomial ring variable
x = symbols('x')

# Sample points (r_i, f(r_i))
points = [
    [0, 51862623363251592162508517414206794722184767070638202339849823866691337237984], 
    [92224930277627368346979232819105863374270231309713817025843616160951811243276, 56615866600258218623028777046502709512840162989889944192521507815101087257162], 
    [11201083720360508467756805128127868575891215698323253753603724605143961889912, 77060686062837686947658593093907838396486178680568877603216153672356292589291], 
    [34374261584511941087352303258744085119283032970590831638349275840230203333896, 62347988278005684880187770398283854167373070160908970395581491408494267411846], 
    [99507503761328176226597764514382663880240267476087200096575037629335693642534, 20291209522788181931144891441995097933003531023931360060659039787557520904838], 
    [70742607118407207507632780324310129296144817170947542555366182239651565135828, 32711561251569889077898473019234620733287395793160950219321095473108932356115], 
    [103548863831696027296233241973313441830979997016314585345883151753703977330112, 27604861161354668427804662024445550188079565071626325688505240862852830874471], 
    [80175046192059288868144293807055650682502997079814157895257473694687464718878, 8431348606599277514817442106328812445290148687882992966206308360568317790473], 
    [53348156642411877769581909269416063960421096575499872857464204105410340692433, 95100414750847203535895010050729591996827624955529760217848800697260306596358], 
    [31444873381552668686456941143061049623165507358292410154427847493480211217841, 14846748594742904774171223240168642258262881957124851534859096138090960966274], 
    [95464452499137690034894006857404423102176495040021952600009514642253499058504, 33276227854020319047785035929937625049621443480370049560983571862372095099645], 
    [68453160103436488712837280102455175345423999183882915392336295454711845771852, 94834930473035912985955313179575015071889659179378095853354241516729179372302], 
    [107893106674197380688198112734692262140949700812581346120399891582788373776100, 26929387866719940019065444409356553648210489543575669794715340624345295314686], 
    [21648578675370321783263992498770881243223159649734038594563978481444613749418, 10377819970746730959087729265691356375964383350702023582311430521325053818871], 
    [82442949937860058867896573026909564307621387638127927427233867284233184263548, 41669702858129475398785132128818897094661470631800406367339354017838983722422], 
    [111768034692954451031012293471113388587682345982130217390061134219829576808656, 73789970309508682211838680696191758977058713678232164614253737715441420894579], 
    [99015513949209498264299799438323538128401540737954069651154265738629506317378, 31806350064452237166799867970607180365348651020385688535883531574165450101768], 
    [72148011523784911677167783599504225941104065255476757612667286906666396938412, 27010219987368507390887922673103862453856279712420489190884698393981483586300], 
    [76728566176213460666401881463108332042383148171869801720092316503184705972769, 95464962841741430343494700691119817579032335483125426096059666934753876201350], 
    [57404702119671692649731402076517778130690019342375611039060956246296399280035, 64759211666358647354537308706484635828892541039898272408033122877824596646376], 
    [89874138776988217313671555130889255541078178125548268432127369276769353750677, 74055171599738610073758633235839371306035507077890066556523296573735803085012], 
    [98567800032613888680818018452969924808942348637818791731795084780874946989440, 99299196528030368003449084520287532617755884156460267094710358324432287099968], 
    [34610858745492679122346325818064546802931170558500380996244169318825906569253, 103259960397814891738621420743144943590298397290283521816194582149518383112197], 
    [36361701977157041061390113890203806321951572267969907881735915639157597338998, 46932857980809618959389179441500577054453074242383952595340797909661241286429]
]

# Extracting r values and f(r) values
r_values = [point[0] for point in points]
y_values = [point[1] for point in points]

# Number of points
n = len(points) - 1  # Degree of polynomial is n

# Construct Lagrange polynomial
P = 0
for i in range(n + 1):
    # Calculate L_i
    L_i = 1
    for j in range(n + 1):
        if i != j:
            L_i *= (x - r_values[j]) / (r_values[i] - r_values[j])
    P += y_values[i] * L_i

# Expand to get polynomial in standard form
P = expand(P)

# Extract coefficients
coefficients = P.as_coefficients_dict()

# Print coefficients
print("Polynomial:", P)
print("Coefficients:")
for term, coeff in coefficients.items():
    print(f"{term}: {coeff}")

# Optional: To get a list of coefficients in order of x^n to x^0
coeffs_list = [coefficients.get(x**i, 0) for i in range(n+1)]
print("Coefficient list (from highest degree to lowest):", coeffs_list)
