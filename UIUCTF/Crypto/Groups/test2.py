import numpy as np
from random import randint
from math import gcd
from challenge import generate_challenge
from gmpy2 import mpz, div, mpfr

def generate_challenge(c):
    a = randint(2, c - 1)
    while gcd(a, c) != 1:
        a = randint(2, c - 1)
    k = randint(2, c - 1)
    return (a, pow(a, k, c), k)


C = 2887148238050771212671429597130393991977609459279722700926516024197432303799152733116328983144639225941977803110929349655578418949441740933805615113979999421542416933972905423711002751042080134966731755152859226962916775325475044445856101949404200039904432116776619949629539250452698719329070373564032273701278453899126120309244841494728976885406024976768122077071687938121709811322297802059565867

(a,b,k) = generate_challenge(C)

ba = div(C, a)


print("a: ", a)
print("")
print("b: ", b)
print("")
print("ba:", ba)
print("")
print("k: ", k)


# c = 1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# a = 549438705271169079787478397456895548305782035889619725539766774150421774110804255171357435489187672633528339300884825782254325194047995710361825968816866863492428764945456332900554683438094075094001928250717058137884186193795385519988216453551459535190813214785837840070171859048799313782373057663687591229876095828200770689029930184634434282886696419928920101190282379237244057674464782595458591
# k = 22220808980179515963403067594728157254637701470619463595669887266643201226864794731801827945619390497788056361966443498948929678177908974263048435587938944455816119788223401662174130131503930596543667457732794478926099907481487051205239265146779328054903175491313542010860084759129172964220692840733874234659056316346735573831890113055999179617273423811839882250978562128473986595693513686478424
# b = 546950501635781292431901410113984810825300036554279059065327856434081487435599399012455464150520910053881231335105724284425906634479144262159306359382045723692611496643027071765250121609700776338991909151854292213549796508178206723717130277308632400193316167826320769800767805011093331114531145068119161794748512134148524207821910372506885754738078606281705683629047885368767644488663280305173761

# c = 1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# a = 104116685434170070142115223977419901347207776598356432772602177240565539849154789199953750815730580486124515475864287047624586476406083076791863470030884447262651812759122045880900655726366025020477137058564904852958013418972623161591956427203068765018251859126863764596615752160273741597155270383825958690997212756445195496108563204922205513242148798251611807333345558732561785716340129432644029
# k = 308233372608218117581094640882175926929442215996057258884140596392088065969591951618627419129191787218376897527684109551273298282358654418525412968194145490125825374707573749556884052746219536591326218021484159407577366536293369108289014324531695317179394248076553048022855535055523629579981671366245903287000584506934108214339106477949756781995743996202700642631792767739165162032780981898035893
# b = 855674565139631648708012599945899188699464410492434439950231140950322423353104106344863900761697526952358428751068282267029694497657937202759874150805834827977897807730153368421096934351321459926068048815555873834510439831144885200590437744141452065777537346392884693068112872874668934312108877030953809739172418986615817508394447954944737108278394601050208698067032765285849803846547738568680589

# c = 1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# a = 874295141358489063151973381716632167695211593048364793133064240494566552204254048251207285502927659538250428366749625385958855205277502436404875448422981802615065949114959350911427718760701182346608412389571999323519641095201837682566944958094677173497559266496827542820854755779359542761320797716865291493697975929977122441290917684890061566161654218328218959216563822140962758184423853785668411
# k = 379066306276326118911029404593973639209206571704910317159255622382836053843814219917497416802078748253429539210085224077390179008388266762322942385944255789467183179999891785761248610943759010423957557922620731186980865590795933258720562095030702845976447065960651373437271152677381281454282845908917359458262040385136259198781229741270792096365640758092775862708815358463540721939159369527428052
# b = 847202234991044396996910879808718240434427855594094110304597527028443786978616712778894751920565359995468523447057800565398023408814581983481942943876574338163933934601256340561800032846763753027155916164428896513166319500921222180523094184888354919892359313267000005612210996422312278077209278708447123614915202096843881483107288709630271158035251971845825793975463045534604936597188889154447921

# c = 1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# a = 596928687256389457639592795010062858530351431962957097329640295334345885889585392947982312281376595372558760382014122487289900287658353601986623389490490271073541150321072563846537775758669770654839927354049040771837255841653554843528125375364782338855702763273424370641286834985414526039963377759364433443544902036774561984348199486248043917273345172782865385850055593851028740196595293701216143
# k = 97497771505497742806278737891795999520217206146054611844174669620806693537866927181241252200861392261685169919101558532679686656710737300830934012676172044554049077393768783553432007407110682476606202270523479256753684745532376235772468266602535712945846826543283536288795796245235820270692616005448641075562248649296357586708934920903088604121601559894212146692665535878945615584485290260371878
# b = 864175298796562383385282776874000788770626039191277910034023973294297920619458886267993604531288471976969497725677744350805037819420879400910070781823058286290139112155842950730570972434461895425107593757865947787361714971408395572562976682552021047388886112906875132456722226380590247259740276898885426689384494915258014860370345935682828425266398956847276889306740509258600050854213105169414049